#!/bin/bash

# Maven Wrapper Script for Linux/Mac

DIRNAME=$(dirname "$0")
WRAPPERDIR="$DIRNAME/.mvn/wrapper"

# Download maven-wrapper.jar if needed
if [ ! -f "$WRAPPERDIR/maven-wrapper.jar" ]; then
    mkdir -p "$WRAPPERDIR"
    echo "Downloading maven wrapper..."
    curl -L -o "$WRAPPERDIR/maven-wrapper.jar" \
        https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.2.0/maven-wrapper-3.2.0.jar
fi

# Download Maven if needed
MAVEN_HOME="$WRAPPERDIR/apache-maven-3.9.6"
if [ ! -f "$MAVEN_HOME/bin/mvn" ]; then
    echo "Downloading Maven 3.9.6..."
    mkdir -p "$WRAPPERDIR/dist"
    curl -L -o "$WRAPPERDIR/dist/maven.zip" \
        https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.9.6/apache-maven-3.9.6-bin.zip
    unzip -q "$WRAPPERDIR/dist/maven.zip" -d "$WRAPPERDIR"
    rm -rf "$WRAPPERDIR/dist"
fi

MAVEN_CMD="$MAVEN_HOME/bin/mvn"

# Run Maven with provided arguments
exec "$MAVEN_CMD" "$@"
